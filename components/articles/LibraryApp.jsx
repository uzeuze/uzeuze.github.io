import React, {Component} from 'react';
import marked from 'marked';

const content = "# Build Basic Library App with React Router, Webpack & Sass\n\n[See live demo on Codepen](http://codepen.io/uzeuze/full/xRbmWw/)\n\nThis tutorial will guide you through a library app. Hopefully by the end of this tutorial, you will be familiar with:\n\n* How to use Sass CSS processor with Webpack.\n* Handle routing with React Router.\n\n#### Reading Material\n\n* [React Router Github page](https://github.com/ReactTraining/react-router)\n* [Sass loader for Webpack](https://github.com/jtangelder/sass-loader)\n\n## Create a new App\n\nCreate a new project folder:\n\n`mkdir library_app`\n\nTo create a package.json file with defaults, run the following command on the terminal:\n\n`npm init -y`\n\nInstall project dependencies locally with:\n\n`npm install --save react react-dom react-router react-bootstrap`\n\nInstall dev dependencies locally with:\n\n`npm install --save-dev babel-core babel-loader babel-preset-es2015 babel-preset-react webpack webpack-dev-server sass-loader css-loader style-loader node-sass`\n\nCreate public folder.\nAdd index.html to public folder. Add Bootstrap CDN to include Bootstrap's CSS styles.\nThe index.html will contain a pretty basic HTML page, whose only purpose is to load the bundled JavaScript file:\n\n```\n<!DOCTYPE html>\n<html lang=\"en\">\n <head>\n   <meta charset=\"utf-8\">\n   <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n   <link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/latest/css/bootstrap.min.css\">\n   <title>Library App</title>\n </head>\n <body>\n   <div id=\"root\"></div>\n   <script type=\"text/javascript\" src=\"/bundle.js\"></script>\n </body>\n</html>\n```\n\nCreate src folder.\nCreate index.js file in src folder.\n\n```javascript\nimport React, {Component} from 'react';\nimport {render} from 'react-dom';\nimport { Router, Route, browserHistory, IndexRoute } from 'react-router'\nimport App from './components/App';\nimport BookListContainer from './components/BookListContainer';\nimport './styles/index.scss';\n\nrender((\n  <Router history={browserHistory}>\n    <Route path=\"/\" component={App}>\n      <IndexRoute component={BookListContainer}/>\n      <Route path=\"/reading-list\" component={BookListContainer}/>\n      <Route path=\"/favourite-books\" component={BookListContainer} />\n    </Route>\n  </Router>\n),document.getElementById('root'));\n```\n\nCreate components folder.\n\n#### App Component\n\nsrc/components/App.js\n\n```\nimport React, {Component} from 'react';\nimport {Link} from 'react-router';\nimport '../styles/App.scss';\n\nexport default class App extends Component {\n  render() {\n    return (\n      <div className=\"App\">\n        <h1 className=\"text-center App__title\">Library App</h1>\n        <ul className=\"nav nav-tabs App__navbar\">\n          <li className=\"nav__item\"><Link to=\"/\" className=\"nav__link\" activeClassName=\"nav__link--active\" onlyActiveOnIndex={true}>All Books</Link></li>\n          <li className=\"nav__item\"><Link to=\"/reading-list\" className=\"nav__link\" activeClassName=\"nav__link--active\">Reading List</Link></li>\n          <li className=\"nav__item\"><Link to=\"/favourite-books\" className=\"nav__link\" activeClassName=\"nav__link--active\">Favourite Books</Link></li>\n        </ul>\n        {this.props.children}\n      </div>\n    );\n  }\n}\n```\n\n#### BookListContainer Component\n\nsrc/components/BookListContainer.js\n\n```\nimport React, {Component} from 'react';\nimport BookList from './BookList';\n\nlet books = [\n  {\n    id: 1,\n    title: \"Robinson Crusoe\",\n    cover: \"https://upload.wikimedia.org/wikipedia/commons/thumb/4/47/SFEC_HULL_CRUSOE1.JPG/640px-SFEC_HULL_CRUSOE1.JPG?1478446004459\",\n    isFavourite: false,\n    toRead: false\n  },\n  {\n    id: 2,\n    title: \"Gulliver's Travels\",\n    cover: \"https://upload.wikimedia.org/wikipedia/commons/thumb/5/58/James_Gillray_The_King_of_Brobdingnag_and_Gulliver.%E2%80%93Vide._Swift%27s_Gulliver-_Voyage_to_Brobdingnag_The_Metropolitan_Museum_of_Art_edit.jpg/640px-James_Gillray_The_King_of_Brobdingnag_and_Gulliver.%E2%80%93Vide._Swift%27s_Gulliver-_Voyage_to_Brobdingnag_The_Metropolitan_Museum_of_Art_edit.jpg?1478446064113\",\n    isFavourite: false,\n    toRead: false\n  },\n  {\n    id: 3,\n    title: \"Ulysses\",\n    cover: \"https://upload.wikimedia.org/wikipedia/commons/a/ab/JoyceUlysses2.jpg?1478446157909\",\n    isFavourite: false,\n    toRead: false\n  },\n  {\n    id: 4,\n    title: \"The Great Gatsby\",\n    cover: \"https://upload.wikimedia.org/wikipedia/en/f/f7/TheGreatGatsby_1925jacket.jpeg?1478446224406\",\n    isFavourite: false,\n    toRead: false\n  },\n  {\n    id: 5,\n    title: \"The Grapes of Wrath\",\n    cover: \"https://upload.wikimedia.org/wikipedia/en/1/1f/JohnSteinbeck_TheGrapesOfWrath.jpg?1478446320367\",\n    isFavourite: false,\n    toRead: false\n  },\n  {\n    id: 6,\n    title: \"Nineteen Eighty-Four\",\n    cover: \"https://upload.wikimedia.org/wikipedia/en/c/c3/1984first.jpg?1478446378416\",\n    isFavourite: false,\n    toRead: false\n  },\n  {\n    id: 7,\n    title: \"The Catcher in the Rye\",\n    cover: \"https://upload.wikimedia.org/wikipedia/en/3/32/Rye_catcher.jpg?1478446438099\",\n    isFavourite: false,\n    toRead: false\n  },\n  {\n    id: 8,\n    title: \"Lord of the Flies\",\n    cover: \"https://upload.wikimedia.org/wikipedia/en/9/9b/LordOfTheFliesBookCover.jpg?1478446475598\",\n    isFavourite: false,\n    toRead: false\n  },\n  {\n    id: 9,\n    title: \"Catch-22\",\n    cover: \"https://upload.wikimedia.org/wikipedia/en/9/99/Catch22.jpg?1478446564001\",\n    isFavourite: false,\n    toRead: false\n  },\n  {\n    id: 10,\n    title: \"A Clockwork Orange\",\n    cover: \"https://upload.wikimedia.org/wikipedia/en/2/23/Clockwork_orange.jpg?1478446614883\",\n    isFavourite: false,\n    toRead: false\n  },\n  {\n    id: 11,\n    title: \"The Stranger\",\n    cover: \"https://upload.wikimedia.org/wikipedia/en/f/f7/L%E2%80%99%C3%89tranger_%28Camus_novel%29.jpg?1478446839229\",\n    isFavourite: false,\n    toRead: false\n  },\n  {\n    id: 12,\n    title: \"The Trial\",\n    cover: \"https://upload.wikimedia.org/wikipedia/en/f/f9/TrialKafka.jpg?1478446904739\",\n    isFavourite: false,\n    toRead: false\n  },\n  {\n    id: 13,\n    title: \"The Little Prince\",\n    cover: \"https://upload.wikimedia.org/wikipedia/en/0/05/Littleprince.JPG?1478446949784\",\n    isFavourite: false,\n    toRead: false\n  },\n  {\n    id: 14,\n    title: \"Darkness at Noon\",\n    cover: \"https://upload.wikimedia.org/wikipedia/commons/7/78/DarknessAtNoon.jpg?1478447162670\",\n    isFavourite: false,\n    toRead: false\n  },\n  {\n    id: 15,\n    title: \"Crime and Punishment\",\n    cover: \"https://upload.wikimedia.org/wikipedia/en/4/4b/Crimeandpunishmentcover.png?1478447271046\",\n    isFavourite: false,\n    toRead: false\n  },\n  {\n    id: 16,\n    title: \"Great Expectations\",\n    cover: \"https://upload.wikimedia.org/wikipedia/commons/thumb/8/8d/Greatexpectations_vol1.jpg/640px-Greatexpectations_vol1.jpg?1478447417564\",\n    isFavourite: false,\n    toRead: false\n  },\n  {\n    id: 17,\n    title: \"The Idiot\",\n    cover: \"https://upload.wikimedia.org/wikipedia/en/0/04/The_Idiot_%28book_cover%29.jpg?1478447491624\",\n    isFavourite: false,\n    toRead: false\n  },\n  {\n    id: 18,\n    title: \"Siddhartha\",\n    cover: \"https://upload.wikimedia.org/wikipedia/commons/thumb/3/3e/Vorzugsausgabe_der_Erstauflage_von_1922%2C_Originalverlagseinband.JPG/640px-Vorzugsausgabe_der_Erstauflage_von_1922%2C_Originalverlagseinband.JPG?1478447605012\",\n    isFavourite: false,\n    toRead: false\n  },\n  {\n    id: 19,\n    title: \"The Hitchhiker's Guide to the Galaxy\",\n    cover: \"https://upload.wikimedia.org/wikipedia/en/b/bd/H2G2_UK_front_cover.jpg?1478447796293\",\n    isFavourite: false,\n    toRead: false\n  },\n  {\n    id: 20,\n    title: \"Oblomov\",\n    cover: \"https://upload.wikimedia.org/wikipedia/commons/thumb/b/bf/Oblomov_1915.jpg/640px-Oblomov_1915.jpg?1478447854924\",\n    isFavourite: false,\n    toRead: false\n  }\n];\n\nexport default class BookListContainer extends Component {\n  constructor() {\n      super();\n      this.state = {\n        books: []\n      }\n      this.handleToReadClick = this.handleToReadClick.bind(this);\n      this.handleFavouriteClick = this.handleFavouriteClick.bind(this);\n  }\n\n  componentDidMount() {\n      this.setState({books: books.slice()});\n  }\n\n  handleToReadClick(book_id) {\n    let newBooks = this.state.books.slice();\n    for(let i=0; i<newBooks.length; i++){\n      if(newBooks[i].id === book_id) {\n        newBooks[i].toRead = !newBooks[i].toRead;\n      }\n    }\n    this.setState({books: newBooks});\n  }\n\n  handleFavouriteClick(book_id) {\n    let newBooks = this.state.books.slice();\n    for(let i=0; i<newBooks.length; i++){\n      if(newBooks[i].id === book_id) {\n        newBooks[i].isFavourite = !newBooks[i].isFavourite;\n      }\n    }\n    this.setState({books: newBooks});\n  }\n\n  render() {\n    let pathName = this.props.location.pathname;\n    let bookData = this.state.books.slice();\n    let bookList,\n        title;\n    switch (pathName) {\n      case '/reading-list':\n        bookList = bookData.filter((book) => {\n          return book.toRead;\n        });\n        title = \"ReadingList\";\n        break;\n        case '/favourite-books':\n          bookList = bookData.filter((book) => {\n            return book.isFavourite;\n          });\n          title = \"FavouriteBooks\";\n          break;\n      default:\n          bookList = books.slice();\n          title = \"All Books\";\n    }\n\n    return (\n      <BookList books={bookList}\n                onToReadClick={this.handleToReadClick}\n                onFavouriteClick={this.handleFavouriteClick}/>\n    );\n  }\n}\n```\n\n#### BookList Component\n\nsrc/components/BookList.js\n\n```\nimport React, {Component} from 'react';\nimport Book from './Book';\nimport {Grid, Row} from 'react-bootstrap';\n\nexport default class BookList extends Component {\n  render() {\n    let books = this.props.books.map((book) => {\n      return (\n              <Book\n                key={book.id}\n                book={book}\n                onToReadClick={this.props.onToReadClick.bind(null,book.id)}\n                onFavouriteClick={this.props.onFavouriteClick.bind(null,book.id)}\n              />\n            );\n    });\n    return (\n      <div>\n        <Grid>\n          <Row>\n            {\n              books.length > 0\n                ? books\n                :\n                <h3 className=\"text-center text-gray\">You don't have any book in that list.</h3>\n            }\n          </Row>\n        </Grid>\n      </div>\n    );\n  }\n}\n\n```\n\n#### Book Component\n\nsrc/components/Book.js\n\n```\nimport React, {Component} from 'react';\nimport {Col, Glyphicon, Tooltip, OverlayTrigger} from 'react-bootstrap';\nimport '../styles/Book.scss';\n\nexport default class Book extends Component {\n  render() {\n    const tooltipRead = (\n      <Tooltip id=\"tooltip-read\">Add/Remove book from reading list.</Tooltip>\n    );\n    const tooltipFavourite = (\n      <Tooltip id=\"tooltip-favourite\">Add/Remove book from favourites.</Tooltip>\n    );\n    return (\n      <Col className=\"Book\" sm={6} md={3}>\n        <div className=\"Book__content\">\n          <img className=\"Book__cover\" src={this.props.book.cover} />\n          <OverlayTrigger placement=\"bottom\" overlay={tooltipRead}>\n            <a\n              className={\n                this.props.book.toRead\n                ? \"Book__button Book__button--read Book__button--active\"\n                : \"Book__button Book__button--read\"\n              }\n              onClick={this.props.onToReadClick}\n            >\n              <Glyphicon className=\"Book__icon\" glyph=\"plus\" />\n            </a>\n          </OverlayTrigger>\n          <OverlayTrigger placement=\"bottom\" overlay={tooltipFavourite}>\n            <a\n              className={\n                this.props.book.isFavourite\n                ? \"Book__button Book__button--favourite Book__button--active\"\n                : \"Book__button Book__button--favourite\"\n              }\n              onClick={this.props.onFavouriteClick}\n            >\n              <Glyphicon className=\"Book__icon\" glyph=\"star\" />\n            </a>\n          </OverlayTrigger>\n        </div>\n        <h4 className=\"text-center text-gray\">{this.props.book.title}</h4>\n      </Col>\n    );\n  }\n}\n\n```\n\n## Add Styles\nCreate stles folder in src directory.\n\nsrc/styles/index.scss\n\n```\n$main-color: #F0F4C3;\n\nbody {\n  background-color: $main-color;\n  color: #FFF;\n}\n\n.text-gray {\n  color: #424242;\n}\n```  \n\nsrc/styles/App.scss\n\n```\n.App__title {\n  color: #ff3466;\n}\n\n.App__navbar {\n  width: 360px;\n  border: none;\n  margin: 0 auto 20px auto;\n\n  .nav__link:hover,\n  .nav__link:active,\n  .nav__link:focus {\n    background-color: #383B76;\n    color: #fff;\n    border-bottom: 0;\n  }\n\n  .nav__link--active {\n    background-color: #383B76;\n    color: #fff;\n    border-bottom: 4px solid #ff3466 !important;\n  }\n}\n\n\n\n@media (max-width: 410px) {\n  .App__navbar {\n    width: 140px;\n    .nav__item {\n      width: 140px;\n      margin-bottom: 10px;\n    }\n    .nav__link {\n      text-align: center;\n    }\n  }\n}\n```  \n\nsrc/styles/Book.scss\n\n```\n.Book {\n  height: 400px;\n}\n\n.Book__content {\n  height: 300px;\n  width: 200px;\n  position: relative;\n  margin: 0 auto;\n}\n\n.Book__cover {\n  height: 300px;\n  width: 200px;\n}\n\n.Book__button {\n  position: absolute;\n  bottom: 10px;\n  height: 40px;\n  width: 40px;\n  border-radius: 50%;\n  text-align: center;\n}\n\n.Book__button--favourite {\n  right: 50px;\n  background-color: #F26F54;\n}\n\n.Book__button--read {\n  right: 5px;\n  background-color: #3FB98C;\n}\n.Book__icon {\n  font-size: 30px;\n  color: #f1f1f1;\n  height: 100%;\n  width: 100%;\n}\n\n.Book__icon::before {\n  position: relative;\n  top: 2px;\n  left: 1px;\n}\n\n.Book__button--active .Book__icon{\n  color: #383B76;\n}\n\n.tooltip.bottom .tooltip-inner {\n    background-color: #ff3466;\n    font-size: 14px;\n  }\n```  \n\n## Webpack Configuration\n```\nmodule.exports = {\n  entry: [\n    './src/index.js'\n  ],\n  output: {\n    path: __dirname + \"/public\",\n    filename: \"bundle.js\"\n  },\n  module: {\n    loaders: [\n      { test: /\.jsx?$/,\n        exclude: /node_modules/,\n        loader: 'babel',\n        query: {\n          presets: ['es2015', 'react']\n        }\n      },\n      {\n        test: /\.scss$/,\n        loaders: [\"style\", \"css\", \"sass\"]\n      }\n    ]\n  },\n  devServer: {\n    contentBase: \"./public\",\n    colors: true,\n    historyApiFallback: true,\n    inline: true\n  }\n};\n```\n\nAdd start script to package.json file.\n```\n\"scripts\": {\n  \"start\": \"node_modules/.bin/webpack-dev-server --progress\"\n},\n```\n\nAdd .gitignore file:\n```\nnode_modules\n.DS_Store\nnpm-debug.log\n```\n\nRun `npm start` and visit http://localhost:8080/";

export default class LibraryApp extends Component {
  rawMarkup(){
    let rawMarkup = marked(this.props.content);
    return { __html: rawMarkup };
  }

  render() {
    return (
      <div>
        <span dangerouslySetInnerHTML= {this.rawMarkup()} />
      </div>
    );
  }
}

LibraryApp.defaultProps = {
  content: content
};
